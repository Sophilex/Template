# 同余与模

## 逆元

在$Z_m$下，整数x存在逆元的充要条件是$(x,m)=1$

$Proof:$

若存在$y \in Z_m,(x,y)=1$则$x,y$满足$xy=km+1,即xy-km=1$,其中$y,m$为未知数.该方程有解的条件是$(x,m)|1$,则$(x,m)=1$

不难发现，如果m是一个质数，则$\forall x \in (1,m-1)$都存在逆元

但是m不是质数的情况下与m互质的x也可以存在逆元

## 欧拉函数/定理

### $O(\sqrt(n))求单个数字的欧拉函数$

$首先将n进行质因数分解，n= \prod_{i=1}^{k} p_i^{\alpha_i}$

考虑欧拉函数的意义：1-n中与n互质的数字的个数

首先减去所有x满足$p1|(x,n)$,这样的x有$n/p_1$个，$对任意p_i$同理

注意到$满足p_1p_2|(x,n)的数字个数被减了两次，所以要加回去一次，也就是 \forall i,j,i\neq j,加上n/(p_ip_j)$

最后，$\phi(n)=n-\sum n/p_i+\sum n/(p_ip_j)-\sum n/(p_ip_jp_k)+...+(-1)^k \sum n/(p_ip_j...p_k)$

$=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})$

$=\prod_{i=1}^{k} p_i^{\alpha_i}*(1-\frac{1}{p_1})(1-\frac{1}{p_2})...(1-\frac{1}{p_k})$

$=\prod_{i=1}^{k}(p_i-1)p_i^{\alpha_i-1}$

即**$\phi(n)=\prod_{i=1}^{k}(p_i-1)p_i^{\alpha_i-1}$**

所以得到$O(sqrt(n))$的算法如下：

